# ------------------------------------
# Shutdown Daemon PowerShell Script
# Version 1.0.2
# -------------------------------------
param (
    [string] $ipAddress,
    [int] $port,
    [string] $secretKey
)

#--------------------------------------------------------------------------------
#                               Important
#
# This script reads information from a .env file located in $appDataPath
# If no .env file is present these values are default
# ipAddress = 0.0.0.0   - IP to bind the Daemon or as start parameter with -ipAddress
# port      = 8080      - Port to bind the Daemon or as start parameter with -port
# secretKey =           - Secret used to communicate with the Wake-on-LAN server, cannot be empty and must be set either in .env or as start parameter with -secretKey
#                         If not set via -secretKey or in .env prompt will come up to enter it.
#------------------------------------------------------------------------------


# -----------------------------
# Begin of Configuration Section
# Set your desired values here
# -----------------------------

$appDataPath = Join-Path -Path $env:APPDATA -ChildPath "shutdown-daemon"
# This creates the daemon's DATA folder named "shutdown-daemon".
# $env:APPDATA points to the user's AppData\Roaming directory.

$bcryptDllPath = Join-Path -Path $appDataPath -ChildPath "BCrypt.Net-Next.dll"
# This defines the path to the BCrypt.Net-Next.dll file, expected to be inside the "shutdown-daemon" folder.

$keyFile = Join-Path -Path $appDataPath -ChildPath "enc.bin"
# This sets the path to the encryption key file "enc.bin", located in the "shutdown-daemon" folder.

$usersFilePath = Join-Path -Path $appDataPath -ChildPath "users.json"
# This defines the path to the users file inside the "shutdown-daemon" folder,
# Used for storing user information in JSON format.

$logFilePath = Join-Path -Path $appDataPath -ChildPath "daemon.log"
# This creates the path for the log file named in the "shutdown-daemon" folder,
# where logging information for the daemon process can be stored.

$envFilePath = Join-Path -Path $appDataPath -ChildPath ".env"
# This constructs the full path to the ".env" file within the "shutdown-daemon" directory in the user's AppData folder.
# It combines the base path stored in $appDataPath with the ".env" file name.

$wolip = "100.125.20.111"
# This variable stores the IP address for Wake-on-LAN (WOL) server.
# It will be used to communicate with the Wake-on-LAN server.

$wolport = "8889"
# This defines the port number to used by the Wake-on-LAN server.

# -----------------------------
# End of Configuration Section
# Set your desired values here
# -----------------------------


# --------------------------------------------------------------------------------------
#                                  Main Script Logic
# Anything after this line will break functionality if you don't know what you're doing.
# ---------------------------------------------------------------------------------------

if (-not (Test-Path -Path $appDataPath)) {
    New-Item -ItemType Directory -Path $appDataPath -Force | Out-Null
}

$global:users = @{}

function Initialize-Users {
    if (-not (Test-Path -Path $appDataPath)) {
        New-Item -ItemType Directory -Path $appDataPath -Force | Out-Null
    }

    if (-not (Test-Path -Path $usersFilePath)) {
        Write-LogMessage "No users file found. Prompting user to set up the first username and password."

        $username = Read-Host "Enter username"
        $password = Read-Host -AsSecureString "Enter password" | ConvertFrom-SecureString -AsPlainText
        $permission = Read-Host "Enter permission level (e.g., 'admin', 'user')"

        $hashedPassword = [BCrypt.Net.BCrypt]::HashPassword($password)

        $global:users = @{
            $username = @{
                "username"      = $username
                "password_hash" = $hashedPassword
                "permission"    = $permission
            }
        }

        $global:users | ConvertTo-Json -Depth 3 | Set-Content -Path $usersFilePath -Force

        Write-LogMessage "First user has been set up and saved successfully." White
    }
    else {
        Write-LogMessage "Loading existing users..." Cyan

        try {
            $global:users = Get-Content -Path $usersFilePath | ConvertFrom-Json
        }
        catch {
            Write-LogMessage "Error loading users from $($usersFilePath): $_"
            Exit
        }

        if ($null -eq $global:users) {
            Write-LogMessage "Failed to load users from $usersFilePath. Exiting."
            Exit
        }

        Write-LogMessage "Users loaded successfully." Cyan
    }
}

function Get-EnvValues {
    # Check if the .env file exists
    if (-not (Test-Path -Path $envFilePath)) {
        Write-Error "The specified .env file does not exist."
        return
    }

    # Create a hashtable to store the key-value pairs
    $envValues = @{}

    # Read the .env file line by line
    Get-Content $envFilePath | ForEach-Object {
        # Skip empty lines and lines that start with '#'
        if (-not ($_ -match '^\s*$') -and -not ($_ -match '^\s*#')) {
            # Split the line at the '=' character to extract key and value
            $key, $value = $_ -split '=', 2

            # Trim any whitespace and store the key-value pair in the hashtable
            $envValues[$key.Trim()] = $value.Trim()
        }
    }

    # Set default values for ipAddress, port, and secretKey if they are not set or are empty
    $ipAddress = if ($envValues['ipAddress']) { $envValues['ipAddress'] } else { "0.0.0.0" }   # Default to 0.0.0.0 or another value
    $port = if ($envValues['port']) { $envValues['port'] } else { "8080" }                      # Default to port 80 or another value
    $secretKey = if ($envValues['secretKey']) { $envValues['secretKey'] } else { "" }         # Default to an empty string

    # Return the values as an object
    return [pscustomobject]@{
        ipAddress = $ipAddress
        port      = $port
        secretKey = $secretKey
    }
}
$global:envData = Get-EnvValues

# Set default values for parameters if they are not provided
if (-not $PSBoundParameters.ContainsKey('ipAddress')) {
    $ipAddress = $global:envData.ipAddress
}

if (-not $PSBoundParameters.ContainsKey('port')) {
    $port = $global:envData.port
}

if (-not $PSBoundParameters.ContainsKey('secretKey')) {
    $secretKey = $global:envData.secretKey
}

if (-not $secretKey) {

    if ($PSCommandPath) {
        # Running as a .ps1 script
        $scriptName = Split-Path $PSCommandPath -Leaf
    }
    elseif ($MyInvocation.MyCommand.Path) {
        # Running as a compiled executable or script
        $scriptName = Split-Path $MyInvocation.MyCommand.Path -Leaf
    }
    elseif ([System.AppDomain]::CurrentDomain.FriendlyName) {
        # Use FriendlyName to get the executable name when running as a compiled executable
        $scriptName = [System.AppDomain]::CurrentDomain.FriendlyName
    }
    else {
        # Fallback for unknown cases
        $scriptName = "UnknownScript"
    }

    Write-Host "🔷 Please enter your secretKey as you did in wol_server.py.`n`   To skip this message Run : $scriptName -secretKey <yourkey>"
    $secretKey = Read-Host -Prompt "secrektKey"
    if (-not $secretKey) {
        Write-LogMessage "❌ Error: The secretKey parameter is required and was not provided." Red
        exit 1
    }
}

function Write-LogMessage {
    param (
        [string] $message,
        [string] $color = "red"
    )
    $timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
    $logMessage = "$timestamp - $message"
    Add-Content -Path $logFilePath -Value $logMessage
    Write-Host $logMessage -ForegroundColor $color
}
function Restore-BcryptDll {
    if (-not (Test-Path $bcryptDllPath)) {
        Write-LogMessage "BCrypt.Net DLL not found, extracting from script..."

        # Base64-encoded BCrypt.Net DLL string (Please DO NOT DELETE THIS LINES)
        $base64Dll = @"
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AACRGGsJhwNEAH8uAAAAAIYYHgkGAEQAhy4AAAAAhhgeCRAARACQLgAAAACGGB4JgwFFAJouAAAAAIMYHgmLA0cAvy4AAAAAhgh7Cn0ASwDHLgAAAACBCIgKEABLANAuAAAAAIYIpQd9AEwA2C4AAAAAgQixBxAATADhLgAAAACGCCQJfQBNAOkuAAAAAIEIMwkQAE0A8i4AAAAAhgjABn0ATgD6LgAAAACBCMwGEABOAH8uAAAAAIYYHgkGAE8Ahy4AAAAAhhgeCRAATwCQLgAAAACGGB4JgwFQAAQvAAAAAJYA2AcUA1IAWC8AAAAAlgBSCZMDUwCYLwAAAACRAIwGmANUAHgwAAAAAJEAwwigA1YAkDAAAAAAkQCrCKADVwDBMAAAAACRAH4CoANYANIwAAAAAJEA3AqHA1kA3jAAAAAAkRhrCYcDWQB/LgAAAACGGB4JBgBZAIcuAAAAAIYYHgkQAFkAkC4AAAAAhhgeCYMBWgD2MAAAAACGGB4JAQBcADExAAAAAIYIFgfsAF0AOTEAAAAAhggbC+wAXQBBMQAAAACGCAQH7ABdAEkxAAAAAIYIDAvsAF0AAAABANULAAACALQGAAADAOkLEBAEAGAJEBAFAEIJAAABANULAAACALQGAAADACEMAAAEACEEAAAFAOkLEBAGADsMEBAHAC0EEBAIAGAJEBAJAEIJAAABAOALEBACAGAJAAABAOALAAABAOALAAABAOALAAACAGAJAAABAOALAAACAGAJAAADADkEAAABAOALAAACADkEEBADAGAJAAABAOALAAACAGAJEBADAFEMAAABAOALAAACAFALAAABAOALAAACAFALAAADAFEMEBAEADkEAAABAGcKAAACAJEHAAADADkEAAABAGAJEBACAJEHAAABAO8GAAACAI0CAAABAO8GAAABAI0LAAACAO8GEBADADkEAAABAI0LAAACAO8GEBADAFEMEBAEADkEAAABAHMCAAACAHwCAAABAJsLAAACADYHAAABAEcGAAACAEcKAAABAP4IAAABALULAAACADALAAABAHACAAACADALAAABAHIKAAABAF0KAAACAGcKAAABAGcKAAACAF0KAAADAGAJAAABANMDAAABANMDAAACAHkIAAABAJUKAAACANAHAAADAGAJAAAEANgGAAABAPcFAAABAPcFAAABAPcFAAABAPcFAAABANMDAAABANMDAAACAHkIAAABAO8GAAABAO8GAAABAO8GAgACAPMKAAABAPcFAAABAPcFAAABAPcFAAABANMDAAABANMDAAACAHkIAAABACgHCQAeCQEAEQAeCQYAGQAeCQoAKQAeCRAAMQAeCRAAOQAeCRAAQQAeCRAASQAeCRAAUQAeCRAAWQAeCRAAYQAeCRAAaQAeCRAAcQAeCRUAkQAeCRAA0QAeCQYA6QAeCRAA8QBvDCEA+QAeCRUA8QC8CiYA8QB1BisAAQHrATEAgQBUCkcA8QDVCk0ADAA3C1kAmQAeCQEAmQCEA2UAmQCEA2sACQFgBnEAmQCEA3YAeQBgBn0AoQBKBIoAEQGoBo8AAQE4BpYAGQFCBAYAqQBKBJwAsQBKBKEAIQEeCaYA8QDsCrQAiQBUCrsAOQEWBtsA8QD5BuwAFABgB/0ADABgBwkBDAD5BuwAWQEcDBMBFAAeCS8BYQGaCFwBFAD5BuwAeQAeCQYAaQEeCW4BiQBKBHQBcQGlC3kBuQAeCQYAuQAeCRAAuQAeCYMB8QB1Bo8B8QA9B5oBCAAEAFMCCAAIAFgCCAAQAF0CCAARAFMCCAAUAFgCAgAVAH0CAgAtAH0CDgAwAAAACAAxAF0CAwA0AGICCAA1AFMCDgA4AGUCAgA5AH0CBgA8AGgCBgBAAGsCCABBAFMCCABoAG4CCABpAFMCCABsAHMCCABwAF0CCAB0AHgCAgB1AH0CCACNAF0CAwChAGICCAC5AF0CAgDFAH0CCADJAF0CLgALAK0DLgATALYDLgAbANUDLgAjAN4DLgArACgELgAzAFcELgA7AGQELgBDAJ0ELgBLAOYFLgBTAPMFLgBbAP4FLgBjAP4FLgBrABMGYABzAE4GIwF7AF0CYQJ7AF0CgQJ7AF0CoQJ7AF0CwQJ7AF0CYAR7AF0CYQR7AF0CgAR7AF0CgQR7AF0CoAR7AF0CoQR7AF0CwAR7AF0CwQR7AF0C4AR7AF0CAAV7AF0CIAV7AF0CQAV7AF0CQAd7AF0CYAd7AF0CgAd7AF0CoAd7AF0CAQAYAAAACwABAEgAAAAMAAEAgAAAAA0AAQAAAgAADgABAAAQAAAPABsANgCBAK0AwQDFAMwA0QDgAPAABAEeATYBSAGKAZQBBAABAAoABQAAAIwKpQMAAMgHpQMAAFUJpQMAANAGpQMAABoHqQMAAB8LqQMAAAgHqQMAABALqQMCACMAAwABACQAAwACACUABQABACYABQACACcABwABACgABwACACkACQABACoACQACADoACwACADsADQACADwADwACAD0AEQBTAPcAkGgAAB4AkHgAAB8AkHoAACAAEHsAACEAKHsAACIABIAAAAQAAAACAAAAAQAAALEBZAsAAAQAAAAAAAAAAAAAAJ8BdQIAAAAABAAAAAEAAQAAAAAAqAFhDAAAAAAKAAYACwAJAAwACQANAAkADgAJAA8ACQBfAGoBAAAARkExQUQyNzBCMjNCQTY0MEU4OEVFN0Y1MUNDOUMwQzFBNkM2QkIxRjJCOTAyNTY4MkE3RDMwRkIzQkRBNjRGMABSZWFkT25seVNwYW5gMQBfX1N0YXRpY0FycmF5SW5pdFR5cGVTaXplPTUxMgBTSEE1MTIAVUludDMyAF9fU3RhdGljQXJyYXlJbml0VHlwZVNpemU9NzIANzIyQTkzMUY0N0NERTU4QUExRUNFNEYzOEVEQjVGRkUwM0FBMTVGNUQ0QzVDQjY2NDExQTEyNzA4NDBEMkZBMgBfX1N0YXRpY0FycmF5SW5pdFR5cGVTaXplPTI0AERlY29kZUJhc2U2NABFbmNvZGVCYXNlNjQAQ2hhcjY0AEluZGV4NjQAU0hBMzg0ADc2RjIxMjUxMDREMTEzREEwMTEyMUZFMEMxNjE5RjI4NjFERTlFRTA1QUJBNUMyODk3MDg3RUI0MDMxMDAzNjUAREMxQ0RFRDYyMDRERjcwQUM1QzY0RUQyQzk5NThGRTc1NDc5NDAwRkUxRTFBODBGNzdDM0E1QkM2RkZBRjBBNQAzMkQwOEEwOEYxRTBCNzlBOTk0RUQ5MDNDMzZBNzk1NkUzNkYxQzk5RDY4RkRCNjc0NjBBQ0FBQzgzQ0E5QzA2AFRvSW50MTYAU0hBMjU2AF9fU3RhdGljQXJyYXlJbml0VHlwZVNpemU9NDA5NgBfX1N0YXRpY0FycmF5SW5pdFR5cGVTaXplPTEyOABTYWZlVVRGOAA8TW9kdWxlPgA8UHJpdmF0ZUltcGxlbWVudGF0aW9uRGV0YWlscz4AdmFsdWVfXwBkYXRhAG1zY29ybGliAElzQXNjaWlOdW1lcmljAG5ld01pbmltdW1Xb3JrTG9hZAA8UmF3SGFzaD5rX19CYWNraW5nRmllbGQAPFNldHRpbmdMZW5ndGg+a19fQmFja2luZ0ZpZWxkADxWZXJzaW9uTGVuZ3RoPmtfX0JhY2tpbmdGaWVsZAA8VmVyc2lvbj5rX19CYWNraW5nRmllbGQAPFdvcmtGYWN0b3I+a19fQmFja2luZ0ZpZWxkADxTZXR0aW5ncz5rX19CYWNraW5nRmllbGQAPEhhc2hPZmZzZXQ+a19fQmFja2luZ0ZpZWxkADxXb3JrZmFjdG9yT2Zmc2V0PmtfX0JhY2tpbmdGaWVsZABBcHBlbmQAU3RyZWFtVG9Xb3JkAFZhbGlkYXRlQW5kUmVwbGFjZVBhc3N3b3JkAEVuaGFuY2VkSGFzaFBhc3N3b3JkAEJhc2U2NENvZGUAbWVzc2FnZQBJRGlzcG9zYWJsZQBSdW50aW1lRmllbGRIYW5kbGUATm9uZQBWYWx1ZVR5cGUARGVmYXVsdEVuaGFuY2VkSGFzaFR5cGUAb2xkSGFzaFR5cGUAbmV3SGFzaFR5cGUAaGFzaFR5cGUARGlzcG9zZQBDcmVhdGUAQXNzZW1ibHlNZXRhZGF0YUF0dHJpYnV0ZQBDb21waWxlckdlbmVyYXRlZEF0dHJpYnV0ZQBEZWJ1Z2dhYmxlQXR0cmlidXRlAEFzc2VtYmx5VGl0bGVBdHRyaWJ1dGUAT2Jzb2xldGVBdHRyaWJ1dGUAVGFyZ2V0RnJhbWV3b3JrQXR0cmlidXRlAEluQXR0cmlidXRlAEFzc2VtYmx5RmlsZVZlcnNpb25BdHRyaWJ1dGUAQXNzZW1ibHlJbmZvcm1hdGlvbmFsVmVyc2lvbkF0dHJpYnV0ZQBBc3NlbWJseUNvbmZpZ3VyYXRpb25BdHRyaWJ1dGUAQXNzZW1ibHlEZXNjcmlwdGlvbkF0dHJpYnV0ZQBDb21waWxhdGlvblJlbGF4YXRpb25zQXR0cmlidXRlAEFzc2VtYmx5UHJvZHVjdEF0dHJpYnV0ZQBBc3NlbWJseUNvcHlyaWdodEF0dHJpYnV0ZQBBc3NlbWJseUNvbXBhbnlBdHRyaWJ1dGUAUnVudGltZUNvbXBhdGliaWxpdHlBdHRyaWJ1dGUAQnl0ZQB2YWx1ZQBQT3JpZwBTT3JpZwBVVEY4RW5jb2RpbmcAQ2VpbGluZwBTeXN0ZW0uUnVudGltZS5WZXJzaW9uaW5nAFRvQmFzZTY0U3RyaW5nAGVuY29kZWRTdHJpbmcASGFzaFN0cmluZwBUb1N0cmluZwBFbXB0eVN0cmluZwBTdWJzdHJpbmcARW5oYW5jZWRIYXNoAElzVmFsaWRIYXNoAEludGVycm9nYXRlSGFzaABDb21wdXRlSGFzaABjdXJyZW50SGFzaABnZXRfUmF3SGFzaABzZXRfUmF3SGFzaAByYXdIYXNoAFBhc3N3b3JkTmVlZHNSZWhhc2gATWF0aABnZXRfTGVuZ3RoAGdldF9TZXR0aW5nTGVuZ3RoAGdldF9WZXJzaW9uTGVuZ3RoAHZlcnNpb25MZW5ndGgAbGVuZ3RoAFN0YXJ0c1dpdGgAQkNyeXB0Lk5ldC1OZXh0LmRsbABOdWwAZ2V0X0l0ZW0AU3lzdGVtAEhhc2hBbGdvcml0aG0ARW51bQBCQ3J5cHRTYWx0TGVuAGJjcnlwdE1pbm9yUmV2aXNpb24AZ2V0X1ZlcnNpb24Ac2V0X1ZlcnNpb24ARGVmYXVsdEhhc2hWZXJzaW9uAHZlcnNpb24AR2V0SGFzaEluZm9ybWF0aW9uAFN5c3RlbS5SZWZsZWN0aW9uAEFyZ3VtZW50T3V0T2ZSYW5nZUV4Y2VwdGlvbgBTYWx0UGFyc2VFeGNlcHRpb24AQXJndW1lbnROdWxsRXhjZXB0aW9uAEJjcnlwdEF1dGhlbnRpY2F0aW9uRXhjZXB0aW9uAEhhc2hJbmZvcm1hdGlvbkV4Y2VwdGlvbgBpbm5lckV4Y2VwdGlvbgBBcmd1bWVudEV4Y2VwdGlvbgBDb3B5VG8AX3AAUm5nQ3NwAElzVmFsaWRCQ3J5cHRCYXNlNjRDaGFyAElzVmFsaWRCQ3J5cHRWZXJzaW9uQ2hhcgBTdHJpbmdCdWlsZGVyAEVuY2lwaGVyAEhhc2hQYXJzZXIAY2hhcmFjdGVyAFJhbmRvbU51bWJlckdlbmVyYXRvcgAuY3RvcgBnZXRfV29ya0ZhY3RvcgBzZXRfV29ya0ZhY3RvcgBmb3JjZVdvcmtGYWN0b3IAR2V0V29ya0ZhY3RvcgB3b3JrRmFjdG9yAC5jY3RvcgBPbGRGb3JtYXREZXNjcmlwdG9yAEhhc2hGb3JtYXREZXNjcmlwdG9yAE5ld0Zvcm1hdERlc2NyaXB0b3IAX3MAU3lzdGVtLkRpYWdub3N0aWNzAEJsb3dmaXNoTnVtUm91bmRzAE1pblJvdW5kcwBEZWZhdWx0Um91bmRzAE1heFJvdW5kcwBTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMAU3lzdGVtLlJ1bnRpbWUuQ29tcGlsZXJTZXJ2aWNlcwBEZWJ1Z2dpbmdNb2RlcwBtYXhpbXVtQnl0ZXMAR2V0Qnl0ZXMAc2FsdEJ5dGVzAGlucHV0Qnl0ZXMAa2V5Qnl0ZXMAZ2V0X1NldHRpbmdzAHNldF9TZXR0aW5ncwBzZXR0aW5ncwBTZWN1cmVFcXVhbHMATWVtb3J5RXh0ZW5zaW9ucwBnZXRfQ2hhcnMAUnVudGltZUhlbHBlcnMAQ29uY2F0AFRocm93SW52YWxpZEhhc2hGb3JtYXQAZm9ybWF0AE9iamVjdABCQ3J5cHQuTmV0AGdldF9IYXNoT2Zmc2V0AGdldF9Xb3JrZmFjdG9yT2Zmc2V0AG9mZnNldABvcF9JbXBsaWNpdABHZW5lcmF0ZVNhbHQAc2FsdABCQ3J5cHQAQ29udmVydABCQ3J5cHQuTmV0LU5leHQAU3lzdGVtLlRleHQAQmZDcnlwdENpcGhlcnRleHQAQ3J5cHRSYXcAYnl0ZUFycmF5AEluaXRpYWxpemVBcnJheQBibG9ja0FycmF5AEVLU0tleQBJbml0aWFsaXplS2V5AGN1cnJlbnRLZXkAaW5wdXRLZXkAbmV3S2V5AEVuaGFuY2VkVmVyaWZ5AFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkAQ29weQBjdXJyZW50S2V5RW5oYW5jZWRFbnRyb3B5AG5ld0tleUVuaGFuY2VkRW50cm9weQBlbmhhbmNlZEVudHJvcHkAU3lzdGVtLk1lbW9yeQBJc051bGxPckVtcHR5AAAAAAAVYwB1AHIAcgBlAG4AdABLAGUAeQAAGUkAbgB2AGEAbABpAGQAIABIAGEAcwBoAAAXYwB1AHIAcgBlAG4AdABIAGEAcwBoAAAtSQBuAHYAYQBsAGkAZAAgAGIAYwByAHkAcAB0ACAAdgBlAHIAcwBpAG8AbgAAL0kAbgB2AGEAbABpAGQAIABiAGMAcgB5AHAAdAAgAHIAZQB2AGkAcwBpAG8AbgAAJ00AaQBzAHMAaQBuAGcAIAB3AG8AcgBrACAAZgBhAGMAdABvAHIAADFXAG8AcgBrACAAZgBhAGMAdABvAHIAIABvAHUAdAAgAG8AZgAgAHIAYQBuAGcAZQAAXUMAdQByAHIAZQBuAHQAIABjAHIAZQBkAGUAbgB0AGkAYQBsAHMAIABjAG8AdQBsAGQAIABuAG8AdAAgAGIAZQAgAGEAdQB0AGgAZQBuAHQAaQBjAGEAdABlAGQAABFpAG4AcAB1AHQASwBlAHkAAFVJAG4AdgBhAGwAaQBkACAAcwBhAGwAdAA6ACAAcwBhAGwAdAAgAGMAYQBuAG4AbwB0ACAAYgBlACAAbgB1AGwAbAAgAG8AcgAgAGUAbQBwAHQAeQAACXMAYQBsAHQAAIDlSQBuAHYAYQBsAGkAZAAgAEgAYQBzAGgAVAB5AHAAZQAsACAAWQBvAHUAIABjAGEAbgAnAHQAIABoAGEAdgBlACAAYQBuACAAZQBuAGgAYQBuAGMAZQBkACAAaABhAHMAaAAgAHcAaQB0AGgAIAB0AHkAcABlACAAbgBvAG4AZQAuACAASABhAHMAaABUAHkAcABlAC4ATgBvAG4AZQAgAGkAcwAgAHUAcwBlAGQAIABmAG8AcgAgAGkAbgB0AGUAcgBuAGEAbAAgAGMAbABhAHIAaQB0AHkAIABvAG4AbAB5AC4AARFoAGEAcwBoAFQAeQBwAGUAAClJAG4AdgBhAGwAaQBkACAAcwBhAGwAdAAgAHYAZQByAHMAaQBvAG4AACtJAG4AdgBhAGwAaQBkACAAcwBhAGwAdAAgAHIAZQB2AGkAcwBpAG8AbgAAJ00AaQBzAHMAaQBuAGcAIABzAGEAbAB0ACAAcgBvAHUAbgBkAHMAADFTAGEAbAB0ACAAcgBvAHUAbgBkAHMAIABvAHUAdAAgAG8AZgAgAHIAYQBuAGcAZQAAAQADAAAABSQAMgAABUQAMgAAFXcAbwByAGsARgBhAGMAdABvAHIAAG9UAGgAZQAgAHcAbwByAGsAIABmAGEAYwB0AG8AcgAgAG0AdQBzAHQAIABiAGUAIABiAGUAdAB3AGUAZQBuACAAewAwAH0AIABhAG4AZAAgAHsAMQB9ACAAKABpAG4AYwBsAHUAcwBpAHYAZQApAABNQgBDAHIAeQBwAHQAIABSAGUAdgBpAHMAaQBvAG4AIABzAGgAbwB1AGwAZAAgAGIAZQAgAGEALAAgAGIALAAgAHgAIABvAHIAIAB5AAAnYgBjAHIAeQBwAHQATQBpAG4AbwByAFIAZQB2AGkAcwBpAG8AbgAAR0UAcgByAG8AcgAgAGgAYQBuAGQAbABpAG4AZwAgAHMAdAByAGkAbgBnACAAaQBuAHQAZQByAHIAbwBnAGEAdABpAG8AbgAAHUkAbgB2AGEAbABpAGQAIABsAGUAbgBnAHQAaAAADWwAZQBuAGcAdABoAAA3SQBuAHYAYQBsAGkAZAAgAG0AYQB4AGkAbQB1AG0AIABiAHkAdABlAHMAIAB2AGEAbAB1AGUAABltAGEAeABpAG0AdQBtAEIAeQB0AGUAcwAAKUIAYQBkACAAbgB1AG0AYgBlAHIAIABvAGYAIAByAG8AdQBuAGQAcwAAH0IAYQBkACAAcwBhAGwAdAAgAEwAZQBuAGcAdABoAAATcwBhAGwAdABCAHkAdABlAHMAAAloAGEAcwBoAAAnSQBuAHYAYQBsAGkAZAAgAEgAYQBzAGgAIABGAG8AcgBtAGEAdAAAAAAxE7BMYsWVQoiNWwoStDzBAAQgAQEIAyAAAQUgAQEREQQgAQEOBSACAQ4OBQcDCAgDBAABAg4EIAEDCAUgAg4ICAQAAQYOEAcJCAMIDh0FHQUSCB0FEk0FIAEdBQ4FAAIODg4FFRFlAQULAAEVEWUBEwAdEwAFIAESTQ4FIAESTQMEIAEODgYgARJNHQMDIAAOCAcDElESVRJZBAAAElEGIAEdBR0FBQABDh0FBAAAElUEAAASWQYgAwEOHA4GBwIdBRJNBgADDg4cHAUgAQEdBQMHAQgGBwISEBJdBAcCCAgJBwYIHQMICAgIBAABDQ0LBwgICB0FCAgICAgDIAAIBgcECQkJCQUVEWEBCQYgARATAAgEBwIICQkgAR+ApRATAAgKAAMBEoCtEoCtCBAHBggIFRFhAQkICBURYQEJBiACAQ8BCBEHBwgICBURYQEJCAgVEWEBCRMHCAgIFRFhAQkICR0FCBURYQEJDRABAgEdHgAVEWEBHgADCgEJBSACAQICBAAAEkUJAAIBEoCtEYC9BiACAQ4SXQQHARIoBCABDggFBwISKAgEIAECDgi3elxWGTTgiQjMexP/zS3dUYCgACQAAASAAACUAAAABgIAAAAkAABSU0ExAAQAAAEAAQD9fTviS8es4/4+ivQHvXxq1VSPmQwujPfL78vZ+MuvSyAcEcRMv3y1zQSSUktaTQ74aDp/mRHJ11BVZiFHR1wnldiWmBGNbMkOv8AHxWCNWBLuRHTsxV8wZK6PxonpsicGQojG1jYM3unAeAQttS6T/qaIXhCWaltXQ2ILw3SK7QQLAAAABBAAAAAEAQAAAAJhAAIAAAIEAAIfAAT/////BAAAAAAEAgAAAAEAAgYIAwYSQQMGERwDBhJFAwYdCQMGHQMDBh0IAgYOAgYDAgYGAwYSKAMGETwDBhE4AwYRNAMGESwDBhEwCAAFDg4ODggCDgAJDg4OAhEcDgIRHAgCBQACDg4IBAABDg4HAAMODggRHAcAAw4OERwIBgADDg4IAggABA4ODgIRHAkAAx0FHQUDERwFAAIOCAMFAAICDggFAAESEA4DAAAOBwADAg4OERwIAAQCDg4CERwHAAICHQUdBQcAAh0DHQUIBgACHQUOCAQAAQgDCSACARURYQEJCAoAAgkVEWUBBRAICCABARURZQEFDSACARURZQEFFRFlAQUPIAMdBRURZQEFFRFlAQUIAwAAAQcgBAEODg4OBAABCA4HAAICDhASKAQAAQIDAygADgMoAAgIAQAIAAAAAAAeAQABAFQCFldyYXBOb25FeGNlcHRpb25UaHJvd3MBCAEAAgAAAAAASQEAGi5ORVRGcmFtZXdvcmssVmVyc2lvbj12NC44AQBUDhRGcmFtZXdvcmtEaXNwbGF5TmFtZRIuTkVUIEZyYW1ld29yayA0LjguAQApQ2hyaXMgTWNLZWUsIFJ5YW4gRC4gRW1lcmwsIERhbWllbiBNaWxsZXIAAAwBAAdSZWxlYXNlAAA4AQAzMjAwNi0yMDIwIENocmlzIE1jS2VlLCBSeWFuIEQuIEVtZXJsLCBEYW1pZW4gTWlsbGVyAACBRwEAgUFBIGZpeGVkLCBlbmhhbmNlZCBhbmQgbmFtZXNwYWNlIGNvbXBhdGlibGUgdmVyc2lvbiBvZiBCQ3J5cHQuTmV0IHBvcnQgb2YgakJDcnlwdCBpbXBsZW1lbnRlZCBpbiBDIy4gSXQgdXNlcyBhIHZhcmlhbnQgb2YgdGhlIEJsb3dmaXNoIGVuY3J5cHRpb24gYWxnb3JpdGht4oCZcyBrZXlpbmcgc2NoZWR1bGUsIGFuZCBpbnRyb2R1Y2VzIGEgd29yayBmYWN0b3IsIHdoaWNoIGFsbG93cyB5b3UgdG8gZGV0ZXJtaW5lIGhvdyBleHBlbnNpdmUgdGhlIGhhc2ggZnVuY3Rpb24gd2lsbCBiZSwgYWxsb3dpbmcgdGhlIGFsZ29yaXRobSB0byBiZSAiZnV0dXJlLXByb29mIi4AAAwBAAc0LjAuMi4wAAAKAQAFNC4wLjIAABQBAA9CQ3J5cHQuTmV0LU5leHQAADoBAA1SZXBvc2l0b3J5VXJsJ2h0dHBzOi8vZ2l0aHViLmNvbS9CY3J5cHROZXQvYmNyeXB0Lm5ldAAASwEARlJlcGxhY2Ugd2l0aCBIYXNoUGFzc3dvcmQsIHRoaXMgbWV0aG9kIHdpbGwgYmUgcmVtb3ZlZCBhdCBhIGxhdGVyIGRhdGUAAAAAReE4ybI8KyUHyO4uXWYDlfidf1jropI0UQHhuwrNRe613VAn7Q5bKxpzyUsiUL3CPW+O2+WeXnPr9NwB85tYCB9ghbC2GO3Ncq4hUxsE/s6tapipG4AFBmAWmPmHLWA7xSFz9MggphKa2Mf2cPgLUHxlFkrcBrl73mnETOwHfdUAAAAA6+Jw7AABTVACAAAAHAEAAHBYAABwOgAAAAAAAAAAAAABAAAAEwAAACcAAACMWQAAjDsAAAAAAAAAAAAAAAEAAREAAACDDgAAs1kAALM7AABSU0RT/yjIOXIBn0ifijcfX5d0MwEAAABCQ3J5cHQuTmV0LU5leHQucGRiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFNIQTI1NgD/KMg5cgGfCB+KNx9fl3Qz6+JwbIHq8DRF+GggwUbNBE1QREKcGAAAjVgLdFRVlj3v1auXV5Wqyv9HfhUS8iGhyP8j33zIh04CJEAUUaxUXkKRSlWlXhVQoCak0gJCbBa2LcOIrSPdo4hNDyLNakTi2Et0tBURZ6Gr7cEeW109aXXEdhpFe8659ZI8ajmfrLXr3n3Pueeee+5595OG7pUNHHBAfybE6qYG69YyWylrABHuxl8vInd1Xy+1TCEeiUJ+L8AeCaAdu+Z2+31O94BC8ssGAIH013XDFawvp3rLurYmLFONAOMW5A0uDxn7W+ErdT7up60/vb8me9PD/or/+IOXzEPPkX8oMqAuebUQEYPIRyxBbETUIdLJLkKPiEXwCEmdA6+2c2pdVOsQ5mr1hNoyDgbVditiGcKo9vtKpwNeECDbqINiowD/iOWzWLZG62BttABPYnkKy8smHVw1CTBp1sElswDJFh0UWgRYh6UdSw5yBQ5KEI8hnkT8EnEGMYl4BXERcQVxFbFfz8GbCL3IQTyiCFGGqEPUI4KIbxEDURx4EG8i/opIlDjYi0il6eCYlww8tBt5uBXRh55fRnyJ+AbBo+cGRCwiBZGFmIczCSB2ISai9fAO4iPEDcRPTHo4gjiKeBpx0iQCZxbBjEgz62EeohnRiViPuNPMAc07HOrw+sxyKqZ5JdIXVbkOeR/WqU2HXFD1af0FDTex9Z3lFrbGszwOERXBpQhuiOBGDaf1j9bwFzgaUwCzyj+FWZ6C9UaVW5BvgHDOE49BfljlZuSxav8zzGcB4jXziUGeoPJUDTewvhRDARI1/sVF8HgNz0MkaHiNypOQz1HtJyJPVuVzuTCfg7wF+SVEEvIMVf7vKrciL8b6U4hk5Hkaf1M0vJgL83zkORRrlRcgL0T+HusjYD2sX4FIQz5f5d2IORr+EtD3LuBeoI6HRQbyqml9LLKQL1L5jxDZmAHTHLcr9H2W0z6Ro+EU47kYxUWa+NHeou2fp+HUf16EPD9CXhAhL4yQF0XI50fIiyP8L4nwf0GE/zYNp31sIfLFKi9DlCJfqvLLKl+G/Bfq3MqQL1fllNPlGl7K1miW0/dcqeHRiKqI/tUaTv7XaDj5X6vh5H+dht+iQtt/UQRfHMGXRHD6M3G01TwHtLuc0LTsZS0XgHaZBRztLZThengXaB/B4xAtLGR+LmIG6fvj2C/PfoFpcqo0hdXbWL2D1b1Mp57VC1ivT9lYXQDqnqJnZyTAeqbjYDpkTQdHInRENpso9o0D+Jn+RaZfzWweZe1e1r5YU/850znOdEaYzXGN9FsmTWcjHmfSETaiVsfHdOKYhR1M5xLTuc50vpj55SCfzT2fm507B/+s41lPqn9t0MP0KXzAKKkrXsD2/wIcg+YDjjJwlIOjAhyVoGy2g6PP7sffgM8nu/09Ht9gu8feB7Lb4emT+2CzXdmMhc8TcPfBNo9vRtLt3CFDn7O/HzwIxRPwOeR22T3g3wyegN8b8KvECVug1+VxDILDJbvBSz8K/fQ6fEGvv8Pp9vi65K1OxelBqUdx+qkyiEa94PLBEMm13jXbHX5s2TZbZb4poNhd/oagX1bA6cbhw1U0CP0e35DdDz7ZD167otAkVvX3K0gVv93nxwvVNEULatUTLuTtfh8OgrNFEVpQAlj0NpLjKGMroJ/67rmL+0Mrf/Jec+/42R9ckVo67nUbNrb/4r3XYn+9xW+OuVi050xcQsPufdssP3z4ePJfe9cseznq7bgD3TC56gn+cRj9rcMz5HW6ZN+CrbKPhaHCVmsrXVBlKy+tKquzldUWVzrK6qocFXYsairlPofcb6+prqmp7KuxV9XZyyuqSmVHVVW/HVx290DAPiBDYy54vH7nkHOHnQXUJ7tkuyKDL+DGVnlmqEocqrK8qhQvotN9Z2Q1tgrok/udbhnWdtU3rihpre/e1L26vrOka0X7ivruFSWdK9Y2d9V3rOhZ1fUDIpW1MPbYkOLw+FzOXlufy4WZuMf9yEa4WgQtTYmDmXe/XH/wMxf/ZG3pD7uDil8esjUE+vtxPFX5yuaOO2EUYPDVf9Mfsxxbfv65S9evJ7/7a1W50eOTVU2TF81aBfgvr+5Xf5x8qvX47q5Nt5yzXFc1mzCpVc1u0nwsAcYWn48bWFvTed/fp+2+cv4vh1TNsNIippQM3znS9l97KLXh7IKcsw/mvmqZNuezb8NEUZX1pEzfe+kB44TyTuN9twl3HYp/vkdVbluFjg55MV0ojLZmXNubxuKpO07y0McPXn5j9NvWUwVy5h8C7+hVpQ55yOMLqrqTWzAgd/HwrWt7ckbPfc2HSnPefOPDhadU3c7AkOxzOhSt5Uk8pOteGvk4/S9NLxTlKmvfOtAcqb1epi9nutfPl3yzAR4DePjYF2Nv9d9ef3IwZcc/9ZQ9rfbqCqcMmxOlabfs2+p0yIptnVux90+vx0V15d7Lkn588Tax6aEDE5//8uOrOyOMYGen3aVmpdr12FaKvQgffXrwyNKmfY3Pfe0rKKnOmqt2vXXIpV3z5Rboi5t6+/nPW5oO3sm/tObz3/ZpFNud7mFVWyDtqwDD/v88+dWaV1pemBp6ZlVh75QYVs/+P6aXocq7Zdx9nP6gjX32ngGf3bs5GK0K1+IOYeJCPi4U5EJ/x4VO8223GMM7m80t+3WKz2FsYB1tnbLfoFYdSvTG0JuhS6H3Qx+EpqxbisqlksM9I1+9duFva+o/kSY8V6ceb6tpffTFldWF+sddtJGPju86ZlbofrfrZXz9VApSNOSLQQnqBSkW2sWgBSqMUjLUkGCOwEdDgjDC08GSIeH5uoHHi1otyRKEIA/zpaA5bKNLwp75Il4t6ojWSEEDZAuSDjaIwSTYIATpVCwdi76D3b3GEpaxO9JYeguV1WN5PVQuH7NtCZd1O6isH2saojJ3rL199Bh6kTR2GzpdTiNkk9O3ktNlIhofPUrVXCM6NY/Hy25V2EeN/1nk/+g+mkD1zARyZybQpE7AEJ7AUjFowhcafpzrBSmR+m+U8I6JzUbIFPB8bxTwSpxL+lt4vHzV8Xhjb+XxGpwmQIOOXTPSxk5liDC6m99ZwU5QDtJEMdxQ+j81tIrBeHxFDlfhXaJq7JLZAKMHBakQH5HBRHDQHItp4ukCRjpXwBnh6GU0eiwNjC897HXNHIWPV0jGA7w4xMUZIFEIctApSCZM5mEW0FCcmcq5oYwAlYFQsbkGK+mhcnwgmgSJhwoB42GmmpkCZeCNLIrJwogRdPdU4lggixAn2UfHMK8WhDrNRlhK/tWIwUwo4DFE+MLmwcTT01wPOaIUAzYe3y3JPLodT+/HAkGKB5Fn0mAMpKA29YwnFcPNKjxkqirRYRX2k7gGlz6mGpwYu8LQLpxTEs+cxJ5ryJkCyo04IexCsYi2iqlfGsVrqRF/ltGYxUZsM5MfLUZcxtm2Gro/xpC1hhWYKJYGdrnrCJ0xb8L7nTX0G5y0lbRjaD0Mxng2zlxxJB4KKRfQyTRSSCG/4nC10WYeCXJJkEGCNBJkyakSVFjtiZBN1nCVCvGObglNkVNCOPJlwkgSdbaAbmeWgMMouAZGJ/1fJSN03RxP5pj1lPAPxwf9+FC1jEtoBNMhhdLZgFMuMaLNTcxmuTCShquZR4k0hDaNCmuOFUYksJBj8ZTWYnBGwfK/Kuhxa7WPTuCVO2W8HEdNoMWYHtp489BLtEPrZ4bGWSZCGaVJLKWJZozAjGr8/1uVi7WPnrHgY2O8z5xBCxENqSYU4ddlgFZKENz7oqGBamxDiRExsEwQKwZFyCLD0wuAk8Zko8TW7ZxP6z0QBXpT2Bc9fShYpoY/j3L6X8ImEWuSgPfoYT1YY504d/qI9OQpqhYLw+mUjekwX82IVNBtK1cjHW25nV4io6NdBhOsTwajKIi4Z3NCLMzRCWNGSI4STJBiERJBh+eGtYGdFfUB/2a83zod7Fhcsd0he9n5qD0o9n5n/bDt+d/ljJy7/NEzf/763OdvvP/Fg5Onf3P7wI0ndJ6p9HePptH7MN9kEDER2VvRnBgThfUA1TMzYySqTx97TU77gNuj+Ok60IgX+nq33RVUnIqOu98b34q3/jZ3+OIc6cf9P7aO7b4e6Hj92dPZDZXXTq+Ovd7Y+cyXJ26cvJu7N+7Iv27ZfiEbx9sYh34kClIUrW0UpNJPPC0L5je9UISMuVSYMgoYy8lhLCefsfw8xvKLGCsOy4rz0yP8+v5A7Sux7rywbusHgvjixNKjjSt/n3RFOdy2NupPSZm/8tWmbO9Z9QEFJMeiCVTyIgpUJv2DKDN7HQXqvNNMo622+xTZd7P9w9Zz59bdqEtdKC7a9/QXD2Ud31F9x2f/8mX0i9zKxRMXBNPJV2Nj8Nllwk0mTZD0QicepfiUL5ijNsA82t0WCzB6CLeluHw8Gm10dhXTWWER8fA10weYLtLWNUNjJNzOi2kfMQiYnZkUUNpeJSzn0B5rEVRVrlMK5ml63iwFi8SzRM4XRiyaZt22xSz7DWCK78GA62yb8UwBoWuYCsjbwYrKETMFzB1liAY3D0n0MGIx+v612P+CVXxl2eGzh5Zl/Cz6qdcfP+EaOH3+yqs/G5ssKjr8cr3x0b3HyFy6QbMWsZqkTQ0nrRXrttFx9CCLMqqIjoF5FIps+sGMou1dGN1fGC4fKA6XB1R+cF7y7CXM1mF3ulfbHYP41NF5erdEdYWfRnq8r1XWltroTeOzD8n0wixZH34KLdlK76R6RZGHel3Ber/f5+wN4PsS5xqnznWif+KeiV0Teyd+ZD3RnvfZ+8mTr9U1f/JB6zdDX954ZHXG8OvDu2tP+fZIiqLM1TijOjJjm7L7+6xes1qv1X149PkH7un8s8ex/paB5vUpH+35ZOCA8UztJ22Laladj6Z0XRv0yjctwANt1gvXQneZB8qefcL29h1X9YNL9ya0HHjorcWPnk20fpU52IFx/m9eaAAAAAAAAAAAAAB4aAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAamgAAAAAAAAAAAAAAABfQ29yRGxsTWFpbgBtc2NvcmVlLmRsbAAAAAAAAAD/JQAgABCmCzHRrLXfmNty/S+33xrQ7a/huJZ+JmpFkHy6mX8s8UeZoST3bJGz4vIBCBb8joXYIGljaU5XcaP+WKR+PZP0j3SVDVi2jnJYzYtx7koVgh2kVHu1WVrCOdUwnBNg8iojsNHF8IVgKBh5QcrvONu4sNx5jg4YOmCLDp5sPooesMF3FdcnSzG92i+veGBcYFXzJVXmlKtVqmKYSFdAFOhjajnKVbYQqyo0XMy0zuhBEa+GVKGT6XJ8ERTusyq8b2Ndxakr9jEYdBY+XM4ek4ebM7rWr1zPJGyBUzJ6d4aVKJhIjzuvuUtrG+i/xJMhKGbMCdhhkakh+2CsfEgygOxdXV2E77F1hekCIybciBtl64E+iSPFrJbT829tDzlC9IOCRAsuBCCEpErwyGlemx+eQmjGIZps6fZhnAxn8IjTq9KgUWpoL1TYKKcPlqMzUatsC+9u5Dt6E1DwO7qYKvt+HWXxoXYBrzk+WcpmiA5DghmG7oy0n29Fw6WEfb5eizvYdW/gcyDBhZ9EGkCmasFWYqrTTgZ3PzZy3/4bPQKbQiTX0DdIEgrQ0+oP25vA8UnJclMHexuZgNh51CX33uj2GlD+4ztMeba94GyXugbABLZPqcHEYJ9Awp5cXmMkahmvb/totVNsPuuyORNv7FI7H1H8bSyVMJtERYHMCb1erwTQ4779SjPeBygPZrNLLhlXqMvAD3TIRTlfC9Lb+9O5vcB5VQoyYBrGAKHWeXIsQP4ln2fMox/7+OmljvgiMtvfFnU8FWth/cgeUC+rUgWt+rU9MmCHI/1IezFTgt8APrtXXJ6gjG/KLlaHGttpF9/2qELVw/9+KMYyZ6xzVU+MsCdbachYyrtdo//hoBHwuJg9+hC4gyH9bLX8SlvT0S155FOaZUX4trxJjtKQl/tL2vLd4TN+y6RBE/ti6MbkztrKIO8BTHc2/p5+0LQf8StN2tuVmJGQrnGOreqg1ZNr0NGO0OAlx68vWzyOt5R1jvvi9o9kKxLyEriIiBzwDZCgXq1PHMOPaJHxz9GtwaizGCIvL3cXDr7+LXXqoR8Ciw/MoOXodG+11vOsGJniic7gT6i0t+AT/YE7xHzZqK3SZqJfFgV3lYAUc8yTdxQaIWUgreaG+rV39UJUx881nfsMr83roIk+e9MbQdZJfh6uLQ4lAF6zcSC7AGgir+C4V5s2ZCQeuQnwHZFjVaqm31mJQ8F4f1Na2aJbfSDFueUCdgMmg6nPlWJoGcgRQUpzTsotR7NKqRR7UgBRGxUpU5o/Vw/W5MabvHakYCsAdOaBtW+6CB/pG1dr7JbyFdkNKiFlY7a2+bnnLgU0/2RWhcVdLbBToY+fqZlHughqB4Vu6XB6S0Qps7UuCXXbIyYZxLCmbq1936dJuGDunGay7Y9xjKrs/xeaaWxSZFbhnrHCpQI2GSlMCXVAE1mgPjoY5JqYVD9lnUJb1uSPa9Y/95kHnNKh9TDo7+Y4LU3BXSXwhiDdTCbrcITG6YJjXsweAj9raAnJ77o+FBiXPKFwamuENX9ohuKgUgVTnLc3B1CqHIQHPlyu3n/sRH2OuPIWVzfaOrANDFDwBB8c8P+zAAIa9QyusnS1PFh6gyW9IQnc+ROR0fYvqXxzRzKUAUf1IoHl5Trc2sI3NHa1yKfd85pGYUSpDgPQDz7HyOxBHnWkmc044i8O6juhu4AyMbM+GDiLVE4IuW1PAw1Cb78ECvaQErgseXyXJHKweVavia+8H3ea3hAIk9kSrouzLj/P3B9yElUkcWsu5t0aUIfNhJ8YR1h6F9oIdLyan7yMfUvpOux67PodhdtmQwlj0sNkxEcYHO8I2RUyNztD3Ra6wiRDTaESUcRlKgIAlFDd5DoTnvjfcVVOMRDWd6yBmxkRX/FWNQRrx6PXOxgRPAmlJFnt5o/y+vvxlyy/up5uPBUecEXjhrFv6eoKXg6Gsyo+WhznH3f6Bj1OudxlKQ8d55nWiT6AJchmUnjJTC5qsxCcug4Vxnjq4pRTPPyl9C0KHqdO9/I9Kx02DyY5GWB5whkIpyNSthIT927+retmH8PqlUW844PIe6bRN3+xKP+MAe/dMsOlWmy+hSFYZQKYq2gPpc7uO5Uv26197yqEL25bKLYhFXBhByl1R93sEBWfYTCozBOWvWHrHv40A89jA6qQXHO1OaJwTAuentUU3qrLvIbM7qcsYmCrXKucboTzsq8ei2TK8L0ZuWkjoFC7WmUyWmhAs7QqPNXpnjH3uCHAGQtUm5mgX4d+mfeVqH09YpqIN/h3LeOXX5PtEYESaBYpiDUO1h/mx6Hf3paZulh4pYT1V2NyIhv/w4OblkbCGusKs81UMC5T5EjZjygxvG3v8utY6v/GNGHtKP5zPHzu2RRKXeO3ZOgUXRBC4BM+ILbi7kXqq6qjFU9s29BPy/pC9ELHtbtq7x07T2UFIc1Bnnke2MdNhYZqR0vkUGKBPfKhYs9GJo1boIOI/KO2x8HDJBV/knTLaQuKhEeFspJWAL9bCZ1IGa10sWIUAA6CIyqNQljq9VUMPvStHWFwPyOS8HIzQX6TjfHsX9bbOyJsWTfefGB07sun8oVAbjJ3zoSAB6aeUPgZVdjv6DWX2WGqp2mpwgYMxfyrBFrcyguALnpEnoQ0RcMFZ9X9yZ4eDtPbc9vNiFUQedpfZ0BDZ+NlNMTF2Dg+cZ74KD0g/23x5yE+FUo9sI8rn+Pm962D22haPen3QIGUHCZM9jQpaZT3IBVB99QCdi5r9LxoAKLUcSQI1Gr0IDO31LdDr2EAUC72OR5GRSSXdE8hFECIi78d/JVNr5G1ltPd9HBFL6Bm7Am8v4WXvQPQbax/BIXLMbMn65ZBOf1V5kcl2poKyqsleFAo9CkEU9qGLAr7bbbpYhTcaABpSNekwA5o7o2hJ6L+P0+MrYfoBuCMtbbW9Hp8Hs6q7F8305mjeM5CKmtANZ7+ILmF89mr1znui04SO/f6yR1WGG1LMWajJrKX4+p0+m46MkNb3ffnQWj7IHjKTvUK+5ez/tisVkBFJ5VIujo6U1WHjYMgt6lr/kuVltC8Z6hVWJoVoWMpqcwz2+GZVkoqpvklMT8cfvRefDEpkALo+P1wLycEXBW7gOMsKAVIFcGVIm3G5D8TwUjchg/H7sn5Bw8fBEGkeUdAF26IXetRXzLRwJvVj8G88mQ1EUE0eHslYJwqYKPo+N8bbGMfwrQSDp4y4QLRT2avFYHRyuCVI2vhkj4zYgskOyK5vu4OorKFmQ265owMct4o96ItRXgS0P2Ut5ViCH1k8PXM52+jSVT6SH2HJ/2dwx6NPvNBY0cKdP8umatubzo3/fj0YNwSqPjd66FM4RuZDWtu2xBVe8Y3LGdtO9RlJwTo0NzHDSnxo/8AzJIPObUL7Q9p+597Zpx9284Lz5Ggo14V2YgvE7skrVtRv3mUe+vWO3azLjk3eVkRzJfiJoAtMS70p61CaDsrasbMTHUSHPEueDdCEmrnUZK35ruhBlBj+0sYEGsa+u3KEdi9JT3Jw+HiWRZCRIYTEgpu7AzZKuqr1U5nr2RfqIbaiOm/vv7D5GRXgLydhsD38Ph7eGBNYANgRoP90bAfOPYErkV3zPw21zNrQoNxqx7wh0GAsF9eADy+V6B3JK7ovZlCRlVhLli/j/RYTqL93fI473T0wr2Jh8P5ZlN0jrPIVfJ1tLnZ/EZhJut6hN8di3kOaoTilV+RjlluRnBXtCCRVdWMTN4CyeGsC7nQBYK7SGKoEZ6pdHW2GX+3Cdyp4KEJLWYzRjLEAh9a6Iy+8AkloJlKEP5uHR09uRrfpKULD/KGoWnxaCiD2rfc/gY5V5vO4qFSf81PAV4RUPqDBqfEtQKgJ9DmDSeM+JpBhj93Bkxgw7UGqGEoehfw4Ib1wKpYYABifdww157mEWPqOCOU3cJTNBbCwlbuy7vetryQoX3863YdWc4J5AVviAF8Sz0KcjkkfJJ8X3LjhrmdTXK0W8Ea/Lie03hVVO21pfwI03w92MQPrU1e71Ae+OZhsdkUhaI8E1Fs58fVb8RO4VbOvyo2N8jG3TQymtcSgmOSjvoOZ+AAYEA3zjk6z/X60zd3wqsbLcVanmewXEI3o09AJ4LTvpu8mZ2OEdUVcw+/fhwt1nvEAMdrG4y3RZChIb6xbrK0bjZqL6tIV3lulLzSdqPGyMJJZe74D1N93o1GHQpz1cZN0EzbuzkpUEa6qegmlawE416+8NX6oZpRLWrijO9jIu6GmrjCicD2LiRDqgMepaTQ8py6YcCDTWrpm1AV5Y/WW2S6+aImKOE6OqeGlalL6WJV79PvL8fa91L3aW8EP1kK+ncVqeSAAYawh63mCZuT5T47Wv2Q6ZfXNJ7Zt/AsUYsrAjqs1ZZ9pn0B1j7P0SgtfXzPJZ8fm7jyrXK01lpM9Yhacawp4OalGeD9rLBHm/qT7Y3E0+jMVzsoKWbV+CguE3mRAV94VWB17UQOlveMXtPj1G0FFbpt9IglYaEDvfBkBRWe68OiV5A87BonlyoHOqmbbT8b9SFjHvtmnPUZ89wmKNkzdfX9VbGCNFYDuzy6ihF3USj42QrCZ1HMq1+SrcxRF+hNjtwwOGJYnTeR+SCTwpB66s57PvtkziFRMr5Pd37jtqhGPSnDaVPeSIDmE2QQCK6iJLJt3f0thWlmIQcJCkaas93ARWTP3mxYrsggHN33vltAjVgbfwHSzLvjtGt+aqLdRf9ZOkQKNT7VzbS8qM7qcruEZPquEmaNR288v2Pkm9KeXS9UG3fCrnBjTvaNDQ50VxNb53EWcvhdfVOvCMtAQMzitE5qRtI0hK8VASgEsOEdOpiVtJ+4Bkigbs6COz9vgqsgNUsdGgH4J3InsWAVYdw/k+creTq7vSVFNOE5iKBLec5Rt8kyL8m6H6B+yBzg9tHHvMMRAc/HquihSYeQGpq9T9TL3trQONoK1SrDOQNnNpHGfDH5jU8rseC3WZ73Orv1Q/8Z1fKcRdknLCKXvyr85hVx/JEPJRWUm2GT5frrnLbOWWSowtGouhJeB8G2DGoF42VQ0hBCpAPLDm7s4DvbmBa+oJhMZOl4MjKVH5/fktPgKzSg0x7ycYlBdAobjDSjSyBxvsXYMnbDjZ813y4vmZtHbwvmHfHjD1TaTOWR2Noez3lizm9+Ps1msRgWBR0s/cXSj4SZIvv2V/Mj9SN2MqYxNaiTAs3MVmKB8Ky163ValzYWbsxz0oiSYpbe0Em5gRuQUEwUVsZxvcfG5goUejIG0OFFmnvyw/1TqskAD6hi4r8lu/bSvTUFaRJxIgIEsnzPy7YrnHbNwD4RU9PjQBZgvas48K1HJZwgOLp2zkb3xaGvd2BgdSBO/suF2I3oirD5qnp+qvlMXMJIGYyK+wLkasMB+eHr1mn41JCg3lymLSUJP5/mCMIyYU63W+J3zuPfj1fmcsM6/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wAAAAABAAAANgAAADcAAAA4AAAAOQAAADoAAAA7AAAAPAAAAD0AAAA+AAAAPwAAAP////////////////////////////////////8CAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAAAARAAAAEgAAABMAAAAUAAAAFQAAABYAAAAXAAAAGAAAABkAAAAaAAAAGwAAAP///////////////////////////////xwAAAAdAAAAHgAAAB8AAAAgAAAAIQAAACIAAAAjAAAAJAAAACUAAAAmAAAAJwAAACgAAAApAAAAKgAAACsAAAAsAAAALQAAAC4AAAAvAAAAMAAAADEAAAAyAAAAMwAAADQAAAA1AAAA//////////////////////////8uAC8AQQBCAEMARABFAEYARwBIAEkASgBLAEwATQBOAE8AUABRAFIAUwBUAFUAVgBXAFgAWQBaAGEAYgBjAGQAZQBmAGcAaABpAGoAawBsAG0AbgBvAHAAcQByAHMAdAB1AHYAdwB4AHkAegAwADEAMgAzADQANQA2ADcAOAA5AGhwck9CbmFlbG9oZVNyZWREeXJjdGJ1b4hqPyTTCKOFLooZE0RzcAMiOAmk0DGfKZj6LgiJbE7s5iEoRXcT0DjPZlS+bAzpNLcprMDdUHzJtdWEPxcJR7XZ1RaSG/t5iQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAQAAAAGAAAgAAAAAAAAAAAAAAAAAAAAQABAAAAMAAAgAAAAAAAAAAAAAAAAAAAAQAAAAAASAAAAFiAAAAsBgAAAAAAAAAAAAAsBjQAAABWAFMAXwBWAEUAUgBTAEkATwBOAF8ASQBOAEYATwAAAAAAvQTv/gAAAQAAAAQAAAACAAAABAAAAAIAPwAAAAAAAAAEAAAAAgAAAAAAAAAAAAAAAAAAAEQAAAABAFYAYQByAEYAaQBsAGUASQBuAGYAbwAAAAAAJAAEAAAAVAByAGEAbgBzAGwAYQB0AGkAbwBuAAAAAAAAALAEjAUAAAEAUwB0AHIAaQBuAGcARgBpAGwAZQBJAG4AZgBvAAAAaAUAAAEAMAAwADAAMAAwADQAYgAwAAAAmAJAAQEAQwBvAG0AbQBlAG4AdABzAAAAQQAgAGYAaQB4AGUAZAAsACAAZQBuAGgAYQBuAGMAZQBkACAAYQBuAGQAIABuAGEAbQBlAHMAcABhAGMAZQAgAGMAbwBtAHAAYQB0AGkAYgBsAGUAIAB2AGUAcgBzAGkAbwBuACAAbwBmACAAQgBDAHIAeQBwAHQALgBOAGUAdAAgAHAAbwByAHQAIABvAGYAIABqAEIAQwByAHkAcAB0ACAAaQBtAHAAbABlAG0AZQBuAHQAZQBkACAAaQBuACAAQwAjAC4AIABJAHQAIAB1AHMAZQBzACAAYQAgAHYAYQByAGkAYQBuAHQAIABvAGYAIAB0AGgAZQAgAEIAbABvAHcAZgBpAHMAaAAgAGUAbgBjAHIAeQBwAHQAaQBvAG4AIABhAGwAZwBvAHIAaQB0AGgAbQAZIHMAIABrAGUAeQBpAG4AZwAgAHMAYwBoAGUAZAB1AGwAZQAsACAAYQBuAGQAIABpAG4AdAByAG8AZAB1AGMAZQBzACAAYQAgAHcAbwByAGsAIABmAGEAYwB0AG8AcgAsACAAdwBoAGkAYwBoACAAYQBsAGwAbwB3AHMAIAB5AG8AdQAgAHQAbwAgAGQAZQB0AGUAcgBtAGkAbgBlACAAaABvAHcAIABlAHgAcABlAG4AcwBpAHYAZQAgAHQAaABlACAAaABhAHMAaAAgAGYAdQBuAGMAdABpAG8AbgAgAHcAaQBsAGwAIABiAGUALAAgAGEAbABsAG8AdwBpAG4AZwAgAHQAaABlACAAYQBsAGcAbwByAGkAdABoAG0AIAB0AG8AIABiAGUAIAAiAGYAdQB0AHUAcgBlAC0AcAByAG8AbwBmACIALgAAAHQAKgABAEMAbwBtAHAAYQBuAHkATgBhAG0AZQAAAAAAQwBoAHIAaQBzACAATQBjAEsAZQBlACwAIABSAHkAYQBuACAARAAuACAARQBtAGUAcgBsACwAIABEAGEAbQBpAGUAbgAgAE0AaQBsAGwAZQByAAAASAAQAAEARgBpAGwAZQBEAGUAcwBjAHIAaQBwAHQAaQBvAG4AAAAAAEIAQwByAHkAcAB0AC4ATgBlAHQALQBOAGUAeAB0AAAAMAAIAAEARgBpAGwAZQBWAGUAcgBzAGkAbwBuAAAAAAA0AC4AMAAuADIALgAwAAAASAAUAAEASQBuAHQAZQByAG4AYQBsAE4AYQBtAGUAAABCAEMAcgB5AHAAdAAuAE4AZQB0AC0ATgBlAHgAdAAuAGQAbABsAAAAjAA0AAEATABlAGcAYQBsAEMAbwBwAHkAcgBpAGcAaAB0AAAAMgAwADAANgAtADIAMAAyADAAIABDAGgAcgBpAHMAIABNAGMASwBlAGUALAAgAFIAeQBhAG4AIABEAC4AIABFAG0AZQByAGwALAAgAEQAYQBtAGkAZQBuACAATQBpAGwAbABlAHIAAABQABQAAQBPAHIAaQBnAGkAbgBhAGwARgBpAGwAZQBuAGEAbQBlAAAAQgBDAHIAeQBwAHQALgBOAGUAdAAtAE4AZQB4AHQALgBkAGwAbAAAAEAAEAABAFAAcgBvAGQAdQBjAHQATgBhAG0AZQAAAAAAQgBDAHIAeQBwAHQALgBOAGUAdAAtAE4AZQB4AHQAAAAwAAYAAQBQAHIAbwBkAHUAYwB0AFYAZQByAHMAaQBvAG4AAAA0AC4AMAAuADIAAAA4AAgAAQBBAHMAcwBlAG0AYgBsAHkAIABWAGUAcgBzAGkAbwBuAAAANAAuADAALgAyAC4AMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAwAAACMOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=
"@
        $dllBytes = [Convert]::FromBase64String($base64Dll)
        [System.IO.File]::WriteAllBytes($bcryptDllPath, $dllBytes)

        Write-LogMessage "BCrypt.Net DLL extracted to $bcryptDllPath" White
    }
    else {
        Write-LogMessage "BCrypt.Net DLL is already present at $bcryptDllPath" Green
    }
}
function Invoke-Key {
    return [System.IO.File]::ReadAllBytes($keyFile)
}

function Import-KeyUserBinary {
    # Generate the current timestamp
    $timestamp = [math]::Floor([double]::Parse((Get-Date -UFormat %s))).ToString()


    # Convert the timestamp and secret key to UTF-8 byte arrays
    $data = [Text.Encoding]::UTF8.GetBytes($timestamp)
    $key = [Text.Encoding]::UTF8.GetBytes($secretKey)

    # Create HMAC-SHA256 object and compute the hash
    $hmacsha256 = New-Object System.Security.Cryptography.HMACSHA256
    $hmacsha256.Key = $key
    $hashBytes = $hmacsha256.ComputeHash($data)

    # Convert the hash to a hexadecimal string
    $hash = -join ($hashBytes | ForEach-Object { "{0:x2}" -f $_ })

    # Prepare the headers and JSON body
    $headers = @{"Content-Type" = "application/json" }
    $jsonBody = @{"signature" = $hash; "timestamp" = $timestamp } | ConvertTo-Json
    $wolurl = "http://${wolip}:${wolport}"

    try {
        # Invoke the REST method
        $response = Invoke-RestMethod -Uri "$wolurl/api/sync_encryption_key" -Method Post -Headers $headers -Body $jsonBody

        # Check if the response contains a success message
        if ($response.success -eq $true) {
            $encryptionKeyBase64 = $response.encryption_key

            if ($encryptionKeyBase64) {
                # Decode the Base64-encoded encryption key back to binary
                $encryptionKeyBinary = [Convert]::FromBase64String($encryptionKeyBase64)

                # Save the binary key to a file named enc.bin
                [System.IO.File]::WriteAllBytes($keyFile, $encryptionKeyBinary)

                Write-LogMessage "Encryption key sync complete $keyFile" Green
            }
            else {
                Write-LogMessage "❌ Error: Failed to retrieve the encryption key from the server response." Red
                exit 1
            }
        }
        else {
            Write-LogMessage "❌ Error: ${response.message}" Red
            exit 1
        }
    }
    catch {
        Write-LogMessage "❌ Error: $_" Red
        exit 1
    }
}

function Import-BcryptDll {
    Restore-BcryptDll
    Add-Type -Path $bcryptDllPath
}

function Start-TcpServer {
    try {
        $global:listener = [System.Net.Sockets.TcpListener]::new([System.Net.IPAddress]::Parse($ipAddress), $port)
        $listener.Start()
        Write-LogMessage "Server started on $($ipAddress):$port" Green

        while ($true) {
            if ($listener.Pending()) {
                $client = $listener.AcceptTcpClient()
                $stream = $client.GetStream()
                $reader = [System.IO.StreamReader]::new($stream)
                $writer = [System.IO.StreamWriter]::new($stream)
                $writer.AutoFlush = $true

                $data = $reader.ReadLine()

                Invoke-ClientRequest -data $data -writer $writer

                $client.Close()
            }
            Start-Sleep -Milliseconds 100
        }
    }
    catch {
        Write-LogMessage "An error occurred: $_"
    }
    finally {
        if ($null -ne $listener) {
            $listener.Stop()
            Write-LogMessage "Server stopped" White
        }
    }
}

function ConvertFrom-Encrypt {
    param (
        [string]$encryptedData
    )

    try {
        $encryptedBytes = [Convert]::FromBase64String($encryptedData)
        $iv = $encryptedBytes[0..15]
        $cipherText = $encryptedBytes[16..($encryptedBytes.Length - 1)]

        $aes = New-Object System.Security.Cryptography.AesManaged
        $aes.Key = Invoke-Key
        $aes.IV = $iv
        $aes.Mode = [System.Security.Cryptography.CipherMode]::CBC
        $aes.Padding = [System.Security.Cryptography.PaddingMode]::PKCS7

        $decryptor = $aes.CreateDecryptor()
        $decryptedBytes = $decryptor.TransformFinalBlock($cipherText, 0, $cipherText.Length)

        # Return the decrypted string
        return [System.Text.Encoding]::UTF8.GetString($decryptedBytes)
    }
    catch {
        # Log the decryption error and return $null
        Write-LogMessage "Decryption error: $_"
        $writer.Write("Decryption error: $_")
        return $null
    }
}

function Invoke-ClientRequest {
    param (
        [string]$data,
        [System.IO.StreamWriter]$writer
    )

    try {
        Write-LogMessage "Data recieved : $data"
        $decryptedData = ConvertFrom-Encrypt -encryptedData $data
        $parts = $decryptedData -split '\|'
        if ($parts.Length -eq 3) {
            $username, $password, $command = $parts

            if ($global:users.PSObject.Properties.Name -contains $username) {
                $user = $global:users.$username

                try {
                    $passwordValid = [BCrypt.Net.BCrypt]::Verify($password, $user.password_hash)
                }
                catch {
                    Write-LogMessage "Error during password verification: $_"
                    $writer.WriteLine("Error during password verification")
                    return
                }

                if ($passwordValid) {
                    switch ($command.ToLower()) {
                        "shutdown" {
                            $writer.WriteLine("Shutdown command received")
                            #Stop-Computer -Force
                            Write-LogMessage "Shutdown command invoked by '$username'. Server will continue running." White
                        }
                        default {
                            $writer.WriteLine("Invalid command")
                            Write-LogMessage "Invalid command received: $command" White
                        }
                    }
                }
                else {
                    $writer.WriteLine("Invalid credentials")
                    Write-LogMessage "Invalid credentials provided by client. Username: '$username'"
                }
            }
            else {
                $writer.WriteLine("User not found")
                Write-LogMessage "User '$username' not found in the users list."
            }
        }
        else {
            $writer.WriteLine("Invalid format")
            Write-LogMessage "Invalid data format received."
        }
    }
    catch {
        Write-LogMessage "Error during decryption or processing: $_"
        $writer.WriteLine("Error during decryption or processing")
    }
}

function Stop-TcpServer {
    if ($null -ne $listener) {
        $listener.Stop()
        Write-LogMessage "Server stopped by user." White
    }
}

$null = Register-EngineEvent -SourceIdentifier ConsoleBreak -Action {
    Write-LogMessage "Ctrl+C detected, stopping the server..." White
    Stop-TcpServer
    Exit
}

Import-BcryptDll
Initialize-Users
Import-KeyUserBinary
Start-TcpServer